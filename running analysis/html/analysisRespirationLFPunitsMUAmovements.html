
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Analysis of LFP responses and coherence between respiration, movement, LFP, MUA and single units</title><meta name="generator" content="MATLAB 8.6"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2015-10-07"><meta name="DC.source" content="analysisRespirationLFPunitsMUAmovements.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Analysis of LFP responses and coherence between respiration, movement, LFP, MUA and single units</h1><!--introduction--><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#2">Load experiment</a></li><li><a href="#3">Extract LFPs in the theta, beta and gamma bands.</a></li><li><a href="#5">Movement - respiration - LFP. Trial-by-trial.</a></li><li><a href="#6">Respiration - LFP - MUA. Trial-by-trial.</a></li><li><a href="#7">Coherence respiration - LFP - MUA</a></li></ul></div><p>Load default parameters</p><pre class="codeinput">load(<span class="string">'parameters.mat'</span>)

odorsRearranged = [1, 8, 2, 9, 3, 10, 4, 11, 5, 12, 6, 13, 7, 14, 15];      <span class="comment">%sort odors</span>
listOdors = {<span class="string">'TMT^-4'</span>, <span class="string">'TMT^-2'</span>, <span class="string">'DMT^-4'</span>, <span class="string">'DMT^-2'</span>, <span class="string">'MT^-4'</span>, <span class="string">'MT^-2'</span>,<span class="keyword">...</span>
             <span class="string">'IBA^-4'</span>, <span class="string">'IBA^-2'</span>, <span class="string">'IAA^-4'</span>, <span class="string">'IAA^-2'</span>, <span class="string">'HXD^-4'</span>, <span class="string">'HXD^-2'</span>, <span class="string">'BTD^-4'</span>, <span class="string">'BTD^-2'</span>, <span class="string">'rose'</span>};
</pre><h2>Load experiment<a name="2"></a></h2><p>This is experiment 081715 - depth: 3800. Mua and LFP from shank 1.</p><p><img vspace="5" hspace="5" src="/Users/Giuliano/Documents/MATLAB/spikeFinder5/running analysis/html/08-17-15_d3800_apcx.png" alt=""> </p><pre class="codeinput">idxShank = 1;
idxShank = shank_lfp(idxShank);
shankToLoad = sprintf(<span class="string">'CSC%d.mat'</span>, idxShank);
load(shankToLoad, <span class="string">'RawSamples'</span>, <span class="string">'lfp_fs'</span>);
load(<span class="string">'mua.mat'</span>);
load(<span class="string">'UnitsNowarp.mat'</span>);
load(<span class="string">'breathing.mat'</span>, <span class="string">'breath'</span>, <span class="string">'sec_on_rsp'</span>, <span class="string">'delay_on'</span>);
load(<span class="string">'movement.mat'</span>);
move = mat2gray(move, [min(move(:)) max(move(:))]);     <span class="comment">%normalize between 0 and 1 for easier comparisons between plots</span>
</pre><h2>Extract LFPs in the theta, beta and gamma bands.<a name="3"></a></h2><pre class="codeinput">newFs = lfp_fs;
lfp(:,1) = downsample(RawSamples,fs/newFs);

n = 4;              <span class="comment">%filter order</span>
fpass = [1 7;<span class="keyword">...</span><span class="comment">    %theta</span>
        10 30;<span class="keyword">...</span><span class="comment">   %beta</span>
        25 50];     <span class="comment">%gamma</span>

<span class="keyword">for</span> idxBand = 1:3;
    [b,a] = butter(n,fpass(idxBand,:)*2/newFs);         <span class="comment">%build filter</span>
    lfp(:,idxBand + 1) = filtfilt(b,a,lfp(:,1));        <span class="comment">%zero-phase bandpass filtering</span>
<span class="keyword">end</span>

<span class="comment">%extract window of interest: 30 sec centered on the onset of the first</span>
<span class="comment">%inhalation after valve onset</span>
row_lfp = zeros(1, (pre+post)*lfp_fs);
lfpTrials = zeros(10, (pre+post)*lfp_fs, odors);
<span class="keyword">for</span> idxOdor = 1:odors   <span class="comment">%cycles through odors</span>
    <span class="keyword">for</span> idxTrial = 1:10     <span class="comment">%cycles through trials</span>
        row_lfp = lfp(floor((sec_on_rsp(idxTrial,idxOdor) - pre)*lfp_fs) : floor((sec_on_rsp(idxTrial,idxOdor) + post)*lfp_fs),1);
        row_lfp1 = row_lfp(1:(pre+post)*lfp_fs);
        lfpTrials(idxTrial,:,idxOdor) = row_lfp1;
        row_lfp = lfp(floor((sec_on_rsp(idxTrial,idxOdor) - pre)*lfp_fs) : floor((sec_on_rsp(idxTrial,idxOdor) + post)*lfp_fs),2);
        row_lfp1 = row_lfp(1:(pre+post)*lfp_fs);
        lfpThetaTrials(idxTrial,:,idxOdor) = row_lfp1;
        row_lfp = lfp(floor((sec_on_rsp(idxTrial,idxOdor) - pre)*lfp_fs) : floor((sec_on_rsp(idxTrial,idxOdor) + post)*lfp_fs),3);
        row_lfp1 = row_lfp(1:(pre+post)*lfp_fs);
        lfpBetaTrials(idxTrial,:,idxOdor) = row_lfp1;
        row_lfp = lfp(floor((sec_on_rsp(idxTrial,idxOdor) - pre)*lfp_fs) : floor((sec_on_rsp(idxTrial,idxOdor) + post)*lfp_fs),4);
        row_lfp1 = row_lfp(1:(pre+post)*lfp_fs);
        lfpGammaTrials(idxTrial,:,idxOdor) = row_lfp1;
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: Matrix is close to singular or badly scaled. Results may be inaccurate.
RCOND =  1.366884e-16. 
</pre><p>Align stimulus to the first inhalation for plotting.</p><pre class="codeinput">delay = [];
stimulusOn = zeros(n_trials, (pre+post)*newFs, odors);
<span class="keyword">for</span> idxOdor = 1:odors   <span class="comment">%cycles through odors</span>
    <span class="keyword">for</span> idxTrial = 1:10     <span class="comment">%cycles through trials</span>
        startOdor = delay_on(idxTrial, idxOdor);
        stimulusOn(idxTrial,pre*newFs - round(startOdor*newFs) : pre*newFs - round(startOdor*newFs) + 2*newFs,idxOdor) = 1;
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><h2>Movement - respiration - LFP. Trial-by-trial.<a name="5"></a></h2><p>Let us consider only 4 odors: TMT 1:100 / TMT 1:10000 / butanedione 1:100 / butanedione 1:10000. A 6 sec window centered on the first inhalation. Black trace: respiration. Red trace: LFP, all bands.</p><pre class="codeinput">idxShank = 1;
params.Fs=lfp_fs;
params.fpass=[1 50];
params.pad=0;
movingwin=[0.5 0.005];
params.tapers=[5 9];
params.trialave = 0;
params.err = 0;

from = 12;
to = 18;
xtime = -3:1/1000:3;
xtimeSniff = -3:1/20000:3;

<span class="keyword">for</span> idxOdor = [1 2 13 14]
    useOdor = odorsRearranged(idxOdor);
    figure
    set(gcf,<span class="string">'Position'</span>,[1 5 1000 900]);
    set(gcf,<span class="string">'Color'</span>,<span class="string">'w'</span>)
    idxPlot = 1;
    p = panel();
    p.pack(<span class="string">'h'</span>,{50 50});
    p(1).pack(<span class="string">'v'</span>, {10 10 10 10 10 10 10 10 10 10});
    <span class="keyword">for</span> i = 1:10
        p(1,i).pack(<span class="string">'v'</span>,{5, 20,75});
    <span class="keyword">end</span>
    p(2).pack(<span class="string">'v'</span>, {10 10 10 10 10 10 10 10 10 10});
    <span class="keyword">for</span> idxTrial = 1:10

        lfpResp = zscore(squeeze(lfpTrials(idxTrial,from*1000:to*1000,useOdor)));
        sniff = zscore(squeeze(breath(idxTrial,from*20000:to*20000,useOdor)));
        odorOn = stimulusOn(idxTrial, from*1000:to*1000, useOdor);
        motion = move(idxTrial,from*1000:to*1000,useOdor); motion = abs(diff(motion)); motion = movingmean(motion,21,2);

        p(1,idxTrial,1).select();
        area(odorOn, <span class="string">'FaceColor'</span>, [51,160,44]/255)
        axis <span class="string">tight</span>, set(gca,<span class="string">'YTick'</span>,[]), set(gca,<span class="string">'YColor'</span>,<span class="string">'w'</span>), set(gca,<span class="string">'XTick'</span>,[]), <span class="comment">%set(gca,'XColor','w');</span>

        p(1,idxTrial,2).select();
        area(motion, <span class="string">'FaceColor'</span>, [106,61,154]/255);
        axis <span class="string">tight</span>, set(gca,<span class="string">'YTick'</span>,[]), set(gca,<span class="string">'YColor'</span>,<span class="string">'w'</span>), set(gca,<span class="string">'XTick'</span>,[]), <span class="comment">%set(gca,'XColor','w');</span>

        p(1,idxTrial,3).select();
        plot(xtimeSniff, sniff, <span class="string">'k'</span>); hold <span class="string">on</span>;
        plot(xtime, lfpResp, <span class="string">'r'</span>);
        axis <span class="string">tight</span>,
        ymax = get(gca, <span class="string">'YLim'</span>);
        plot([0 0], ymax, <span class="string">'color'</span>, [44,162,95]/255, <span class="string">'linewidth'</span>, 1);
        set(gca,<span class="string">'YTick'</span>,[]), set(gca,<span class="string">'YColor'</span>,<span class="string">'w'</span>),
<span class="comment">%         while idxTrial &lt; 10</span>
<span class="comment">%             set(gca,'XTick',[]); set(gca,'XColor','w');</span>
<span class="comment">%         end</span>


        p(2,idxTrial).select();
        [S1,t,f]=mtspecgramc(lfpResp', movingwin, params);
        S1(floor(length(t)/2), :) = max(S1(:));
        plot_matrix(S1,t,f); axis <span class="string">tight</span>

    <span class="keyword">end</span>
    p.title(listOdors(idxOdor))
    p.de.margin = 1;
    p.margin = [8 6 4 6];
    p(2).marginleft = 30;
    <span class="keyword">for</span> i = 1:10
    p(1,i).marginbottom = 3;
    <span class="keyword">end</span>
    p.select(<span class="string">'all'</span>);
<span class="keyword">end</span>
</pre><pre class="codeoutput">Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
Warning: a panel had zero size, and the managed object was hidden 
</pre><img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_01.png" style="width:1000px;height:800px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_02.png" style="width:1000px;height:800px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_03.png" style="width:1000px;height:800px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_04.png" style="width:1000px;height:800px;" alt=""> <h2>Respiration - LFP - MUA. Trial-by-trial.<a name="6"></a></h2><p>Let us compare MUA and LFP/respiration. And let us zoom-in.</p><pre class="codeinput">idxShank = 1;
from = 13;
to = 17;
xtime = -2:1/1000:2;
xtimeSniff = -2:1/20000:2;

<span class="keyword">for</span> idxOdor = [1 2 13 14]
    useOdor = odorsRearranged(idxOdor);
    figure
    set(gcf,<span class="string">'Position'</span>,[1 5 1200 900]);
    set(gcf,<span class="string">'Color'</span>,<span class="string">'w'</span>)
    idxPlot = 1;
    p = panel();
    p.pack(<span class="string">'h'</span>,{50 50});
    p(1).pack(<span class="string">'v'</span>, {20 20 20 20 20});
    p(2).pack(<span class="string">'v'</span>, {20 20 20 20 20});
    <span class="keyword">for</span> i = 1:5
        p(1,i).pack(<span class="string">'v'</span>,{5,95});
        p(2,i).pack(<span class="string">'v'</span>,{5,95});
    <span class="keyword">end</span>

    <span class="keyword">for</span> idxTrial = 1:5

        lfpResp = zscore(squeeze(lfpTrials(idxTrial,from*1000:to*1000,useOdor)));
        sniff = zscore(squeeze(breath(idxTrial,from*20000:to*20000,useOdor)));
        odorOn = stimulusOn(idxTrial, from*1000:to*1000, useOdor);

        p(1,idxTrial,1).select();
        area(odorOn, <span class="string">'FaceColor'</span>, [51,160,44]/255)
        axis <span class="string">tight</span>, set(gca,<span class="string">'YTick'</span>,[]), set(gca,<span class="string">'YColor'</span>,<span class="string">'w'</span>), set(gca,<span class="string">'XTick'</span>,[]), <span class="comment">%set(gca,'XColor','w');</span>

        p(1,idxTrial,2).select();
        plot(xtimeSniff, sniff, <span class="string">'k'</span>, <span class="string">'linewidth'</span>, 1); hold <span class="string">on</span>;
        plot(xtime,zscore(shankMua(idxShank).odor(useOdor).sdf_trialMua(idxTrial,from*1000 :to*1000)), <span class="string">'color'</span>, [117,107,177]/255, <span class="string">'linewidth'</span>, 1);
        axis <span class="string">tight</span>,
        ymax = get(gca, <span class="string">'YLim'</span>);
        plot([0 0], ymax, <span class="string">'color'</span>, [44,162,95]/255, <span class="string">'linewidth'</span>, 1);
        set(gca,<span class="string">'YTick'</span>,[]), set(gca,<span class="string">'YColor'</span>,<span class="string">'w'</span>),

        p(2,idxTrial,1).select();
        area(odorOn, <span class="string">'FaceColor'</span>, [51,160,44]/255)
        axis <span class="string">tight</span>, set(gca,<span class="string">'YTick'</span>,[]), set(gca,<span class="string">'YColor'</span>,<span class="string">'w'</span>), set(gca,<span class="string">'XTick'</span>,[]), <span class="comment">%set(gca,'XColor','w');</span>

        p(2,idxTrial,2).select();
        plot(xtime, lfpResp, <span class="string">'r'</span>, <span class="string">'linewidth'</span>, 1); hold <span class="string">on</span>
        plot(xtime,zscore(shankMua(idxShank).odor(useOdor).sdf_trialMua(idxTrial,from*1000 :to*1000)), <span class="string">'color'</span>, [117,107,177]/255, <span class="string">'linewidth'</span>, 1);
        axis <span class="string">tight</span>,
        ymax = get(gca, <span class="string">'YLim'</span>);
        plot([0 0], ymax, <span class="string">'color'</span>, [44,162,95]/255, <span class="string">'linewidth'</span>, 1);

    <span class="keyword">end</span>
    p.title(listOdors(idxOdor))
    p.de.margin = 1;
    p.margin = [8 6 4 6];
    p(2).marginleft = 30;
    <span class="keyword">for</span> i = 1:5
    p(1,i).marginbottom = 3;
    <span class="keyword">end</span>
    p.select(<span class="string">'all'</span>);
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_05.png" style="width:1200px;height:800px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_06.png" style="width:1200px;height:800px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_07.png" style="width:1200px;height:800px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_08.png" style="width:1200px;height:800px;" alt=""> <h2>Coherence respiration - LFP - MUA<a name="7"></a></h2><p>Let us see what the coherence between these three signals lokks like. Two odors: TMT 1:100 and butanedione 1:100. Two trials (first and fifth trial) for each odor The x axis is time in ms. Onset: 3000 ms. The y axis tells you the length</p><pre class="codeinput"><span class="comment">%of a cycle in ms.</span>
idxShank = 1;
from = 12;
to = 18;

wname  = <span class="string">'cmor1-1'</span>; <span class="comment">%I'm using a wavelet here</span>
scales = 1:512;
ntw = 2;

<span class="keyword">for</span> idxOdor = [2  14]
    <span class="keyword">for</span> idxTrial = [1 5]
        A(1,:) = zscore(-downsample(squeeze(breath(idxTrial,from*20000:to*20000,idxOdor)),20));
        A(2,:) = -zscore((squeeze(lfpTrials(idxTrial,from*1000:to*1000,idxOdor))));
        A(3,:) = zscore(shankMua(idxShank).odor(idxOdor).sdf_trialMua(idxTrial,from*1000 :to*1000));
        x = A(1,:);
        y = A(2,:);
        z = A(3,:);
        wcoher(x,y,scales,wname,<span class="string">'ntw'</span>,ntw,<span class="string">'plot'</span>,<span class="string">'all'</span>);    <span class="comment">%resp vs LFP</span>
        wcoher(x,z,scales,wname,<span class="string">'ntw'</span>,ntw,<span class="string">'plot'</span>,<span class="string">'all'</span>);    <span class="comment">%resp vs MUA</span>
        wcoher(y,z,scales,wname,<span class="string">'ntw'</span>,ntw,<span class="string">'plot'</span>,<span class="string">'all'</span>);    <span class="comment">%</span>
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_09.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_10.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_11.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_12.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_13.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_14.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_15.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_16.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_17.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_18.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_19.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_20.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_21.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_22.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_23.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_24.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_25.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_26.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_27.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_28.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_29.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_30.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_31.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_32.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_33.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_34.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_35.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_36.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_37.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_38.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_39.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_40.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_41.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_42.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_43.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_44.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_45.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_46.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_47.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_48.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_49.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_50.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_51.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_52.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_53.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_54.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_55.png" style="width:576px;height:585px;" alt=""> <img vspace="5" hspace="5" src="analysisRespirationLFPunitsMUAmovements_56.png" style="width:576px;height:585px;" alt=""> <p>h_ax_lfp = gca;         h_ax_raster = axes('position', get(h_ax_lfp, 'position'));         plotSpikeRaster(rasterUnits(idxOdor).trial(idxTrial).units,'PlotType','scatter','XLimForCell', [from*1000 to*1000]); %         hold on %         for idxCell = 1:length(shank_unitPairs) %             plot([1 (to-from)*1000], [idxCell idxCell], 'LineColor', [15 15 15]); %         end %         hold off         %plotSpikeRaster(rasterUnits(idxOdor).trial(idxTrial).units,'PlotType','vertline', 'VertSpikeHeight', 1,'XLimForCell', [from*1000 to*1000]);         set(h_ax_raster, 'YAxisLocation', 'right', 'xlim', get(h_ax_lfp, 'xlim'), 'color', 'none');         set(h_ax_raster,'YTick',[])         set(h_ax_lfp,'YTick',[])         set(h_ax_raster,'YColor','w')         set(h_ax_lfp,'YColor','w')         set(h_ax_raster,'FontName','Arial','Fontsize',10,'FontWeight','normal','TickDir','out','Box','off');         set(h_ax_lfp,'XTick',[])</p><pre class="codeinput"><span class="comment">% for idxOdor = 1:15</span>
<span class="comment">%     figure;</span>
<span class="comment">%     plot(mean(shankMua(idxShank).odor(idxOdor).sdf_trialMua(:,pre*1000 - 1000:pre*1000+1000)))</span>
<span class="comment">% end</span>
</pre><p class="footer"><br><a href="http://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2015b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Analysis of LFP responses and coherence between respiration, movement, LFP, MUA and single units

%%
% Load default parameters
load('parameters.mat')

odorsRearranged = [1, 8, 2, 9, 3, 10, 4, 11, 5, 12, 6, 13, 7, 14, 15];      %sort odors
listOdors = {'TMT^-4', 'TMT^-2', 'DMT^-4', 'DMT^-2', 'MT^-4', 'MT^-2',...
             'IBA^-4', 'IBA^-2', 'IAA^-4', 'IAA^-2', 'HXD^-4', 'HXD^-2', 'BTD^-4', 'BTD^-2', 'rose'};

%% Load experiment
% This is experiment 081715 - depth: 3800. Mua and LFP from shank 1.
% 
% <</Users/Giuliano/Documents/MATLAB/spikeFinder5/running analysis/html/08-17-15_d3800_apcx.png>>
% 
idxShank = 1;
idxShank = shank_lfp(idxShank);
shankToLoad = sprintf('CSC%d.mat', idxShank);
load(shankToLoad, 'RawSamples', 'lfp_fs');
load('mua.mat');
load('UnitsNowarp.mat');
load('breathing.mat', 'breath', 'sec_on_rsp', 'delay_on');
load('movement.mat');
move = mat2gray(move, [min(move(:)) max(move(:))]);     %normalize between 0 and 1 for easier comparisons between plots


%% Extract LFPs in the theta, beta and gamma bands.
newFs = lfp_fs;
lfp(:,1) = downsample(RawSamples,fs/newFs);

n = 4;              %filter order
fpass = [1 7;...    %theta
        10 30;...   %beta
        25 50];     %gamma 

for idxBand = 1:3;
    [b,a] = butter(n,fpass(idxBand,:)*2/newFs);         %build filter
    lfp(:,idxBand + 1) = filtfilt(b,a,lfp(:,1));        %zero-phase bandpass filtering
end

%extract window of interest: 30 sec centered on the onset of the first
%inhalation after valve onset
row_lfp = zeros(1, (pre+post)*lfp_fs);
lfpTrials = zeros(10, (pre+post)*lfp_fs, odors);
for idxOdor = 1:odors   %cycles through odors
    for idxTrial = 1:10     %cycles through trials
        row_lfp = lfp(floor((sec_on_rsp(idxTrial,idxOdor) - pre)*lfp_fs) : floor((sec_on_rsp(idxTrial,idxOdor) + post)*lfp_fs),1);
        row_lfp1 = row_lfp(1:(pre+post)*lfp_fs);
        lfpTrials(idxTrial,:,idxOdor) = row_lfp1;
        row_lfp = lfp(floor((sec_on_rsp(idxTrial,idxOdor) - pre)*lfp_fs) : floor((sec_on_rsp(idxTrial,idxOdor) + post)*lfp_fs),2);
        row_lfp1 = row_lfp(1:(pre+post)*lfp_fs);
        lfpThetaTrials(idxTrial,:,idxOdor) = row_lfp1;
        row_lfp = lfp(floor((sec_on_rsp(idxTrial,idxOdor) - pre)*lfp_fs) : floor((sec_on_rsp(idxTrial,idxOdor) + post)*lfp_fs),3);
        row_lfp1 = row_lfp(1:(pre+post)*lfp_fs);
        lfpBetaTrials(idxTrial,:,idxOdor) = row_lfp1;
        row_lfp = lfp(floor((sec_on_rsp(idxTrial,idxOdor) - pre)*lfp_fs) : floor((sec_on_rsp(idxTrial,idxOdor) + post)*lfp_fs),4);
        row_lfp1 = row_lfp(1:(pre+post)*lfp_fs);
        lfpGammaTrials(idxTrial,:,idxOdor) = row_lfp1;
    end
end

%% 
% Align stimulus to the first inhalation for plotting.
delay = [];
stimulusOn = zeros(n_trials, (pre+post)*newFs, odors);
for idxOdor = 1:odors   %cycles through odors
    for idxTrial = 1:10     %cycles through trials
        startOdor = delay_on(idxTrial, idxOdor);
        stimulusOn(idxTrial,pre*newFs - round(startOdor*newFs) : pre*newFs - round(startOdor*newFs) + 2*newFs,idxOdor) = 1;
    end
end

%% Movement - respiration - LFP. Trial-by-trial.
% Let us consider only 4 odors: TMT 1:100 / TMT 1:10000 / butanedione 1:100
% / butanedione 1:10000.
% A 6 sec window centered on the first inhalation.
% Black trace: respiration. 
% Red trace: LFP, all bands.
idxShank = 1;
params.Fs=lfp_fs;
params.fpass=[1 50];
params.pad=0;
movingwin=[0.5 0.005];
params.tapers=[5 9];
params.trialave = 0;
params.err = 0;

from = 12;
to = 18;
xtime = -3:1/1000:3;
xtimeSniff = -3:1/20000:3;

for idxOdor = [1 2 13 14]
    useOdor = odorsRearranged(idxOdor);
    figure
    set(gcf,'Position',[1 5 1000 900]);
    set(gcf,'Color','w')
    idxPlot = 1;
    p = panel();
    p.pack('h',{50 50});
    p(1).pack('v', {10 10 10 10 10 10 10 10 10 10});
    for i = 1:10
        p(1,i).pack('v',{5, 20,75});
    end
    p(2).pack('v', {10 10 10 10 10 10 10 10 10 10});
    for idxTrial = 1:10
        
        lfpResp = zscore(squeeze(lfpTrials(idxTrial,from*1000:to*1000,useOdor)));
        sniff = zscore(squeeze(breath(idxTrial,from*20000:to*20000,useOdor)));
        odorOn = stimulusOn(idxTrial, from*1000:to*1000, useOdor);
        motion = move(idxTrial,from*1000:to*1000,useOdor); motion = abs(diff(motion)); motion = movingmean(motion,21,2);       
        
        p(1,idxTrial,1).select();
        area(odorOn, 'FaceColor', [51,160,44]/255)
        axis tight, set(gca,'YTick',[]), set(gca,'YColor','w'), set(gca,'XTick',[]), %set(gca,'XColor','w');
        
        p(1,idxTrial,2).select();      
        area(motion, 'FaceColor', [106,61,154]/255);
        axis tight, set(gca,'YTick',[]), set(gca,'YColor','w'), set(gca,'XTick',[]), %set(gca,'XColor','w');
        
        p(1,idxTrial,3).select();
        plot(xtimeSniff, sniff, 'k'); hold on; 
        plot(xtime, lfpResp, 'r'); 
        axis tight, 
        ymax = get(gca, 'YLim');
        plot([0 0], ymax, 'color', [44,162,95]/255, 'linewidth', 1);
        set(gca,'YTick',[]), set(gca,'YColor','w'),
%         while idxTrial < 10
%             set(gca,'XTick',[]); set(gca,'XColor','w');
%         end
        
        
        p(2,idxTrial).select();
        [S1,t,f]=mtspecgramc(lfpResp', movingwin, params);
        S1(floor(length(t)/2), :) = max(S1(:));
        plot_matrix(S1,t,f); axis tight
          
    end
    p.title(listOdors(idxOdor))
    p.de.margin = 1;
    p.margin = [8 6 4 6];
    p(2).marginleft = 30;
    for i = 1:10
    p(1,i).marginbottom = 3;
    end
    p.select('all');
end

%% Respiration - LFP - MUA. Trial-by-trial.
% Let us compare MUA and LFP/respiration. And let us zoom-in.
idxShank = 1;
from = 13;
to = 17;
xtime = -2:1/1000:2;
xtimeSniff = -2:1/20000:2;

for idxOdor = [1 2 13 14]
    useOdor = odorsRearranged(idxOdor);
    figure
    set(gcf,'Position',[1 5 1200 900]);
    set(gcf,'Color','w')
    idxPlot = 1;
    p = panel();
    p.pack('h',{50 50});
    p(1).pack('v', {20 20 20 20 20});
    p(2).pack('v', {20 20 20 20 20});
    for i = 1:5
        p(1,i).pack('v',{5,95});
        p(2,i).pack('v',{5,95});
    end
    
    for idxTrial = 1:5
        
        lfpResp = zscore(squeeze(lfpTrials(idxTrial,from*1000:to*1000,useOdor)));
        sniff = zscore(squeeze(breath(idxTrial,from*20000:to*20000,useOdor)));
        odorOn = stimulusOn(idxTrial, from*1000:to*1000, useOdor);    
        
        p(1,idxTrial,1).select();
        area(odorOn, 'FaceColor', [51,160,44]/255)
        axis tight, set(gca,'YTick',[]), set(gca,'YColor','w'), set(gca,'XTick',[]), %set(gca,'XColor','w');
        
        p(1,idxTrial,2).select();
        plot(xtimeSniff, sniff, 'k', 'linewidth', 1); hold on; 
        plot(xtime,zscore(shankMua(idxShank).odor(useOdor).sdf_trialMua(idxTrial,from*1000 :to*1000)), 'color', [117,107,177]/255, 'linewidth', 1);
        axis tight, 
        ymax = get(gca, 'YLim');
        plot([0 0], ymax, 'color', [44,162,95]/255, 'linewidth', 1);
        set(gca,'YTick',[]), set(gca,'YColor','w'),

        p(2,idxTrial,1).select();
        area(odorOn, 'FaceColor', [51,160,44]/255)
        axis tight, set(gca,'YTick',[]), set(gca,'YColor','w'), set(gca,'XTick',[]), %set(gca,'XColor','w');
        
        p(2,idxTrial,2).select();
        plot(xtime, lfpResp, 'r', 'linewidth', 1); hold on
        plot(xtime,zscore(shankMua(idxShank).odor(useOdor).sdf_trialMua(idxTrial,from*1000 :to*1000)), 'color', [117,107,177]/255, 'linewidth', 1);
        axis tight, 
        ymax = get(gca, 'YLim');
        plot([0 0], ymax, 'color', [44,162,95]/255, 'linewidth', 1);
          
    end
    p.title(listOdors(idxOdor))
    p.de.margin = 1;
    p.margin = [8 6 4 6];
    p(2).marginleft = 30;
    for i = 1:5
    p(1,i).marginbottom = 3;
    end
    p.select('all');
end

%% Coherence respiration - LFP - MUA
% Let us see what the coherence between these three signals lokks like. Two
% odors: TMT 1:100 and butanedione 1:100. Two trials (first and fifth
% trial) for each odor
% The x axis is time in ms. Onset: 3000 ms. The y axis tells you the length 
%of a cycle in ms.
idxShank = 1;
from = 12;
to = 18;

wname  = 'cmor1-1'; %I'm using a wavelet here
scales = 1:512;
ntw = 2;

for idxOdor = [2  14]
    for idxTrial = [1 5]
        A(1,:) = zscore(-downsample(squeeze(breath(idxTrial,from*20000:to*20000,idxOdor)),20));
        A(2,:) = -zscore((squeeze(lfpTrials(idxTrial,from*1000:to*1000,idxOdor))));
        A(3,:) = zscore(shankMua(idxShank).odor(idxOdor).sdf_trialMua(idxTrial,from*1000 :to*1000));
        x = A(1,:);
        y = A(2,:);
        z = A(3,:);
        wcoher(x,y,scales,wname,'ntw',ntw,'plot','all');    %resp vs LFP
        wcoher(x,z,scales,wname,'ntw',ntw,'plot','all');    %resp vs MUA
        wcoher(y,z,scales,wname,'ntw',ntw,'plot','all');    %   
    end
end
        

%%
% 
% h_ax_lfp = gca;
%         h_ax_raster = axes('position', get(h_ax_lfp, 'position'));
%         plotSpikeRaster(rasterUnits(idxOdor).trial(idxTrial).units,'PlotType','scatter','XLimForCell', [from*1000 to*1000]);
% %         hold on
% %         for idxCell = 1:length(shank_unitPairs)
% %             plot([1 (to-from)*1000], [idxCell idxCell], 'LineColor', [15 15 15]);
% %         end
% %         hold off
%         %plotSpikeRaster(rasterUnits(idxOdor).trial(idxTrial).units,'PlotType','vertline', 'VertSpikeHeight', 1,'XLimForCell', [from*1000 to*1000]);
%         set(h_ax_raster, 'YAxisLocation', 'right', 'xlim', get(h_ax_lfp, 'xlim'), 'color', 'none');
%         set(h_ax_raster,'YTick',[])
%         set(h_ax_lfp,'YTick',[])
%         set(h_ax_raster,'YColor','w')
%         set(h_ax_lfp,'YColor','w')
%         set(h_ax_raster,'FontName','Arial','Fontsize',10,'FontWeight','normal','TickDir','out','Box','off');
%         set(h_ax_lfp,'XTick',[])
%%


% for idxOdor = 1:15
%     figure;
%     plot(mean(shankMua(idxShank).odor(idxOdor).sdf_trialMua(:,pre*1000 - 1000:pre*1000+1000)))
% end
##### SOURCE END #####
--></body></html>